#include <pgmspace.h>
#include "MyHomeIRTransmitter.h"
#include "utils/validate.h"

/* Koizumiシーリングライト */
const uint16_t CMD_KOIZUMI_CL_OFF_H[263] PROGMEM = {
  3328, 1734,  346, 1322,  346, 452,  368, 474,  348, 474,  348, 474,  348, 474,  348, 474,  348, 474,  346, 452,  372, 472,  348, 472,  348, 476,  346, 1322,
  348, 474,  346, 472,  348, 474,  348, 472,  350, 448,  374, 448,  372, 474,  348, 1322,  348, 1322,  348, 450,  372, 472,  348, 474,  348, 472,  348, 472,
  348, 472,  348, 1322,  348, 472,  430, 1242,  348, 474,  348, 1320,  348, 1298,  372, 1320,  348, 1322,  348, 472,  348, 1320,  432, 390,
  350, 1320,  348, 472,  348, 472,  350, 472,  350, 472,  348, 472,  348, 472,  350, 472,  350, 452,  370, 1322,  348, 1320,  348, 1322,  348, 1320,
  348, 1322,  428, 1240,  350, 1320,  348, 1322,  348, 1322,  348, 1322,  348, 472,  348, 472,  350, 474,  348, 472,  350, 450,  370, 472,  348, 472,
  348, 474,  348, 1320,  350, 1300,  370, 1284,  384, 1320,  350, 1320,  350, 1320,  348, 472,  350, 1318,  350, 474,  348, 474,  348, 450,  372, 450,
  370, 1320,  348, 1320,  350, 1320,  348, 472,  350, 1322,  348, 1322,  348, 1300,  370, 1298,  372, 474,  348, 474,  348, 36622,  3472, 1828,
  374, 472,  396, 496,  372, 1368,  372, 1366,  372, 472,  396, 1344,  396, 496,  374, 470,  398, 472,  398, 1366,  372, 498,  372, 498,  372, 1368,  372, 472,
  396, 1366,  372, 496,  372, 1366,  374, 496,  372, 496,  374, 1366,  374, 496,  372, 496,  372, 472,  398, 496,  374, 1366,  374, 1366,  372, 1366,
  374, 1366,  374, 496,  374, 1368,  372, 496,  374, 496,  374, 496,  374, 1364,  374, 1366,  374, 496,  374, 496,  374, 1366,  374, 472,  396, 470,  398};  // UNKNOWN 1BA63FE6
const uint64_t CMD_KOIZUMI_CL_OFF = 0x17600FF;

const uint16_t CMD_KOIZUMI_CL_HI_H[263] PROGMEM = {
  3326, 1732,  348, 1322,  348, 474,  348, 474,  348, 452,  370, 474,  348, 450,  370, 474,  348, 474,  430, 392,  348, 474,  348, 472,  348, 474,
  348, 1298,  372, 472,  348, 472,  348, 452,  452, 390,  350, 472,  348, 452,  370, 474,  348, 1320,  348, 1322,  348, 450,  370, 474,  348, 472,  350, 472,
  348, 474,  348, 472,  348, 1320,  350, 472,  350, 1320,  350, 472,  350, 1322,  348, 1320,  350, 1322,  348, 1322,  348, 452,  370, 1296,  374, 474,
  348, 1298,  372, 472,  350, 472,  350, 472,  350, 448,  372, 474,  348, 472,  350, 472,  350, 472,  350, 1320,  350, 1320,  348, 1320,  350, 1320,
  348, 1298,  372, 1320,  348, 1322,  348, 1320,  348, 474,  348, 1320,  350, 472,  348, 472,  350, 472,  348, 472,  348, 472,  350, 472,  350, 1320,
  348, 472,  350, 1322,  348, 1320,  350, 1298,  372, 1320,  348, 1300,  370, 1320,  350, 472,  428, 1242,  350, 472,  350, 472,  348, 472,  350, 472,
  350, 1322,  348, 1320,  348, 1320,  350, 472,  350, 1322,  348, 1320,  350, 1322,  348, 1322,  348, 472,  348, 474,  348, 36256,  3472, 1830,
  372, 496,  372, 496,  372, 1368,  374, 1366,  372, 498,  372, 1366,  372, 496,  374, 496,  372, 496,  372, 1368,  372, 496,  374, 496,  374, 1344,
  396, 474,  396, 1366,  374, 496,  374, 1366,  372, 496,  374, 496,  374, 1366,  374, 494,  374, 496,  374, 474,  396, 494,  374, 496,  374, 496,  372, 1366,
  374, 1366,  374, 496,  372, 1366,  374, 496,  374, 496,  372, 1366,  374, 496,  374, 1342,  398, 496,  372, 496,  374, 1366,  374, 496,  372, 496,  374};  // UNKNOWN DF82D5A
const uint64_t CMD_KOIZUMI_CL_HI = 0x176807F;

const uint16_t CMD_KOIZUMI_CL_MED_H[263] PROGMEM = {
  3326, 1734,  348, 1322,  348, 450,  370, 474,  432, 390,  348, 472,  348, 474,  348, 474,  348, 474,  348, 450,  370, 474,  348, 472,  348, 474,  348, 1322,
  348, 472,  348, 474,  348, 474,  348, 474,  348, 474,  348, 474,  348, 472,  350, 1296,  372, 1322,  346, 474,  350, 472,  348, 474,  348, 472,  350, 472,
  348, 474,  348, 1320,  348, 472,  350, 1300,  368, 472,  348, 1322,  348, 1320,  348, 1322,  348, 1320,  348, 474,  348, 1320,  350, 472,
  348, 1320,  348, 472,  350, 472,  348, 472,  348, 474,  348, 472,  350, 472,  350, 474,  348, 472,  350, 1296,  372, 1324,  346, 1320,  350, 1320,
  350, 1320,  348, 1322,  348, 1320,  348, 1320,  350, 474,  348, 472,  350, 1320,  350, 472,  348, 474,  350, 472,  348, 474,  348, 472,  350, 1320,
  350, 1320,  348, 472,  350, 1322,  348, 1322,  430, 1240,  348, 1320,  350, 1320,  350, 450,  370, 1320,  348, 474,  348, 472,  348, 472,  350, 472,
  348, 1322,  348, 1320,  350, 1320,  348, 472,  350, 1296,  372, 1322,  348, 1300,  370, 1298,  370, 472,  432, 388,  350, 36610,  3550, 1750,
  372, 496,  374, 498,  372, 1368,  372, 1368,  374, 496,  372, 1368,  370, 496,  372, 496,  374, 494,  376, 1364,  374, 496,  374, 496,  372, 1366,  374, 496,
  372, 1366,  374, 496,  374, 1366,  374, 496,  374, 496,  374, 1366,  374, 496,  374, 496,  374, 496,  374, 496,  374, 1366,  372, 496,  374, 1364,  374, 1366,
  374, 496,  374, 1366,  374, 496,  374, 496,  374, 496,  374, 496,  374, 1366,  374, 496,  374, 494,  374, 1344,  396, 496,  374, 496,  372};  // UNKNOWN 93001E0
const uint64_t CMD_KOIZUMI_CL_MED = 0x17640BF;

const uint16_t CMD_KOIZUMI_CL_LOW_H[263] PROGMEM = {
  3378, 1658,  370, 1298,  370, 474,  348, 448,  372, 474,  346, 472,  348, 474,  348, 448,  374, 472,  348, 472,  348, 474,  348, 474,  348, 448,  374, 1298,
  370, 450,  372, 472,  348, 474,  348, 472,  348, 472,  348, 448,  374, 472,  350, 1320,  348, 1300,  370, 472,  350, 474,  348, 472,  350, 472,  350, 472,
  348, 452,  370, 1276,  394, 474,  348, 1320,  348, 472,  348, 1320,  348, 1320,  350, 1320,  348, 1320,  350, 472,  348, 1322,  348, 472,
  350, 1320,  348, 472,  348, 472,  350, 472,  350, 472,  348, 472,  348, 472,  350, 472,  348, 448,  372, 1320,  350, 1320,  350, 1320,  350, 1322,
  348, 1322,  348, 1322,  348, 1322,  348, 1322,  348, 1320,  350, 472,  350, 472,  348, 1320,  348, 472,  350, 472,  348, 472,  348, 472,  350, 472,
  350, 1320,  348, 1320,  348, 472,  350, 1320,  348, 1320,  348, 1322,  348, 1320,  348, 472,  350, 1320,  350, 448,  374, 450,  370, 472,  350, 450,
  372, 1298,  372, 1322,  348, 1322,  348, 472,  350, 1320,  350, 1320,  350, 1320,  348, 1298,  372, 472,  350, 472,  350, 36528,  3470, 1830,
  372, 498,  372, 470,  452, 1314,  374, 1340,  400, 496,  374, 1368,  372, 496,  374, 470,  398, 496,  374, 1366,  374, 496,  372, 496,  374, 1366,  374, 496,
  374, 1368,  372, 496,  374, 1366,  372, 496,  374, 496,  372, 1366,  372, 496,  372, 496,  374, 494,  374, 496,  372, 496,  374, 1366,  374, 1366,  374, 1366,
  374, 496,  374, 1366,  374, 496,  372, 468,  402, 1364,  374, 1366,  374, 1366,  372, 496,  374, 470,  400, 1366,  374, 496,  374, 496,  374};  // UNKNOWN 1A227366
const uint64_t CMD_KOIZUMI_CL_LOW = 0x176C03F;

/* Hitachiエアコン */

// OFF
const uint16_t CMD_HITACHI_AC_OFF[531] PROGMEM = {
  3298, 1748,  356, 1326,  358, 484,  358, 484,  356, 484,  358, 484,  358, 484,  358, 484,  358, 484,  356, 484,  358, 484,  358, 484,  358, 482,
  358, 1326,  358, 484,  358, 482,  360, 482,  358, 484,  358, 484,  358, 484,  358, 484,  358, 484,  358, 484,  358, 484,  358, 482,  358, 484,
  358, 482,  358, 484,  360, 482,  360, 482,  360, 482,  360, 1326,  358, 482,  358, 1306,  380, 1324,  360, 1326,  358, 1326,  360, 1324,  358, 1326,
  358, 482,  360, 1324,  360, 1326,  358, 1326,  358, 1326,  360, 1326,  358, 1326,  358, 1292,  392, 1326,  358, 1306,  380, 482,  358, 482,  360, 482,
  360, 482,  358, 484,  358, 484,  358, 484,  358, 482,  360, 482,  358, 482,  360, 1326,  358, 1302,  382, 482,  360, 484,  358, 1326,  358, 1326,
  358, 1326,  358, 1326,  358, 482,  358, 484,  358, 1326,  358, 1326,  358, 482,  360, 482,  360, 482,  360, 1302,  382, 482,  360, 482,  360, 1326,
  358, 482,  360, 482,  360, 1326,  358, 1326,  358, 482,  358, 1326,  360, 1326,  358, 482,  360, 1302,  382, 1326,  358, 484,  358, 1326,  360, 1326,
  358, 482,  360, 482,  358, 1324,  360, 482,  360, 482,  360, 482,  360, 482,  358, 482,  360, 1326,  358, 1326,  358, 482,  360, 1326,  358, 1306,
  380, 1324,  360, 482,  358, 482,  360, 482,  358, 482,  360, 482,  360, 1326,  358, 1304,  382, 482,  358, 1326,  358, 1324,  360, 1326,  358, 1326,
  358, 1326,  360, 482,  360, 482,  360, 1324,  360, 482,  358, 482,  360, 482,  360, 482,  360, 482,  358, 482,  360, 482,  358, 484,  358, 1326,
  360, 1324,  360, 1326,  358, 1324,  360, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 482,  360, 482,  360, 482,  360, 482,  358, 482,  360, 482,
  360, 482,  360, 482,  358, 1326,  358, 1326,  360, 1326,  358, 1326,  358, 1326,  358, 1302,  382, 1324,  360, 1326,  358, 482,  360, 482,  358, 484,
  358, 482,  358, 482,  360, 482,  358, 482,  360, 482,  360, 1324,  360, 1326,  358, 1324,  360, 1328,  356, 1326,  358, 1328,  358, 1326,  358, 1324,
  358, 484,  358, 484,  358, 482,  358, 482,  360, 482,  360, 482,  360, 482,  360, 482,  360, 1326,  358, 1326,  358, 1326,  358, 1326,  360, 1326,
  358, 1326,  358, 1326,  358, 1302,  382, 482,  358, 482,  360, 482,  360, 482,  360, 482,  358, 482,  360, 482,  358, 482,  360, 1324,  358, 1326,
  358, 1326,  360, 1324,  360, 1326,  358, 1326,  358, 1328,  356, 1326,  358, 1326,  360, 1326,  360, 482,  358, 482,  358, 1326,  360, 482,  360, 1326,
  360, 482,  360, 482,  358, 484,  358, 1324,  360, 1274,  408, 484,  358, 1300,  384, 482,  360, 1326,  358, 1326,  358, 482,  360, 484,  358, 482,
  360, 482,  358, 484,  358, 1324,  360, 1282,  402, 482,  360, 1326,  358, 1326,  358, 1324,  358, 1326,  360, 1326,  358, 482,  360, 482,  360, 482,
  360, 482,  358, 482,  358, 484,  358, 482,  360, 482,  360, 482,  360, 482,  358, 1326,  360, 1326,  358, 1326,  358, 1304,  380, 1326,  360, 1324,
  360, 1326,  358, 1326,  358, 484,  358, 482,  358, 484,  358, 482,  358, 484,  358, 484,  358, 482,  360, 482,  360, 1326,  358, 1326,  358, 1326,
  358, 1326,  358, 1326,  360, 1304,  380, 1326,  358, 1326,  358};  // UNKNOWN 313FA79A

// 暖房20度
const uint16_t CMD_HITACHI_AC_HEAT[531] PROGMEM = {
  3276, 1750,  356, 1326,  358, 484,  358, 484,  358, 484,  356, 484,  358, 484,  356, 484,  358, 484,  358, 484,  356, 486,  356, 484,  358, 484,  358, 1326,
  358, 484,  358, 484,  358, 484,  356, 484,  358, 460,  382, 484,  358, 484,  358, 484,  358, 482,  358, 484,  358, 482,  358, 484,  358, 484,  358, 484,
  358, 482,  360, 482,  358, 484,  356, 1326,  358, 484,  358, 1326,  358, 1326,  358, 1326,  358, 1328,  358, 1326,  358, 1306,  378, 484,  358, 1326,
  358, 1326,  358, 1326,  358, 1326,  358, 1304,  380, 1326,  358, 1326,  358, 1326,  360, 1326,  358, 482,  358, 484,  358, 484,  358, 482,  360, 482,
  358, 482,  358, 484,  358, 482,  358, 484,  358, 484,  358, 1304,  380, 1326,  358, 484,  358, 484,  358, 1326,  358, 1326,  358, 1326,  358, 1326,
  358, 482,  358, 482,  360, 1326,  358, 1326,  358, 482,  360, 482,  358, 484,  358, 1326,  358, 484,  358, 482,  358, 1326,  358, 484,
  358, 482,  360, 1326,  358, 1324,  360, 484,  358, 1324,  360, 1304,  380, 482,  360, 1304,  380, 1326,  358, 482,  358, 1306,  380, 1326,
  358, 482,  360, 484,  358, 1326,  358, 484,  358, 460,  382, 482,  360, 482,  358, 484,  358, 1326,  358, 1326,  358, 484,  358, 1326,
  360, 1326,  358, 1326,  358, 482,  358, 482,  360, 482,  358, 482,  360, 1326,  358, 482,  360, 1324,  360, 482,  360, 1326,  358, 1326,  358, 1326,
  358, 1326,  358, 482,  358, 1326,  358, 484,  358, 1326,  358, 484,  358, 484,  358, 482,  360, 482,  358, 484,  358, 462,  380, 484,  358, 482,  358, 1326,
  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 484,  358, 484,  358, 484,  358, 458,  384, 482,  358, 484,
  358, 482,  358, 482,  360, 1326,  358, 1326,  358, 1326,  358, 1304,  380, 1326,  358, 1326,  358, 1326,  360, 1326,  358, 482,  358, 484,  358, 484,
  358, 482,  360, 460,  382, 484,  358, 482,  360, 482,  360, 1324,  358, 1326,  358, 1324,  360, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,
  358, 482,  358, 484,  358, 484,  358, 482,  358, 482,  360, 482,  360, 484,  356, 484,  358, 1326,  358, 1326,  358, 1324,  360, 1326,  358, 1326,
  358, 1328,  358, 1306,  378, 1326,  358, 484,  358, 484,  358, 484,  358, 484,  358, 484,  358, 482,  360, 482,  358, 484,  358, 1326,  358, 1326,
  358, 1326,  358, 1326,  358, 1326,  358, 1304,  380, 1326,  358, 1326,  358, 482,  358, 1326,  358, 1326,  358, 484,  358, 484,  358, 482,  358, 1326,
  358, 484,  358, 1326,  358, 484,  358, 482,  358, 1326,  358, 1326,  358, 1326,  358, 462,  378, 1326,  360, 1304,  380, 482,  360, 482,  360, 484,
  358, 1326,  358, 482,  358, 1326,  358, 1302,  382, 482,  358, 1326,  358, 1326,  358, 1326,  358, 484,  358, 1326,  358, 484,  358, 482,  358, 484,
  358, 462,  380, 482,  360, 482,  358, 482,  358, 482,  358, 484,  358, 482,  358, 1326,  358, 1326,  358, 1326,  358, 1328,  358, 1326,  358, 1326,
  358, 1326,  360, 1326,  358, 484,  358, 462,  378, 482,  360, 484,  358, 460,  382, 482,  360, 444,  396, 484,  358, 1302,  382, 1326,  358, 1326,
  358, 1326,  360, 1324,  358, 1326,  358, 1326,  360, 1326,  358};  // UNKNOWN 99E17332

// 冷房24度
const uint16_t CMD_HITACHI_AC_COOL[531] PROGMEM = {
  3278, 1750,  356, 1326,  358, 460,  380, 486,  356, 486,  356, 484,  356, 462,  380, 486,  358, 460,  380, 462,  380, 484,  356, 484,  358, 484,  358, 1324,
  358, 486,  356, 484,  356, 484,  358, 484,  358, 484,  358, 484,  356, 484,  358, 462,  380, 484,  356, 462,  380, 460,  382, 484,  436, 404,  358, 484,
  358, 484,  358, 460,  382, 484,  358, 1326,  358, 482,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 484,  358, 1326,
  38, 1248,  356, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1328,  356, 1326,  358, 1326,  358, 484,  358, 484,  358, 482,  358, 484,  358, 482,
  360, 484,  356, 484,  358, 484,  358, 482,  358, 482,  358, 1328,  358, 1326,  358, 484,  358, 484,  358, 1326,  358, 1326,  360, 1326,  358, 1326,
  358, 482,  358, 484,  358, 1302,  384, 1302,  382, 462,  378, 484,  358, 460,  382, 1326,  358, 484,  358, 482,  358, 1304,  380, 484,  358, 484,  358, 1298,
  386, 1326,  358, 484,  358, 1326,  358, 1326,  358, 484,  358, 1326,  358, 1326,  358, 484,  358, 1326,  358, 1326,  358, 484,  358, 484,
  358, 1304,  380, 484,  358, 484,  358, 484,  358, 484,  358, 484,  358, 1302,  382, 1326,  358, 484,  358, 1328,  356, 1326,  358, 1326,  358, 484,
  358, 484,  358, 482,  358, 482,  360, 482,  358, 1300,  384, 1326,  358, 482,  358, 1328,  358, 1324,  358, 1304,  380, 1326,  358, 1304,  382, 484,
  358, 482,  360, 1326,  358, 482,  360, 482,  358, 484,  358, 482,  358, 484,  358, 482,  358, 484,  358, 484,  358, 1304,  380, 1326,
  358, 1326,  358, 1326,  358, 1326,  358, 1328,  358, 1304,  380, 1326,  358, 484,  358, 484,  358, 484,  358, 460,  382, 484,  358, 484,  356, 484,
  358, 482,  360, 1326,  358, 1326,  358, 1326,  358, 1328,  358, 1326,  358, 1302,  384, 1324,  360, 1326,  358, 482,  358, 482,  358, 484,
  358, 484,  358, 458,  382, 482,  360, 482,  358, 484,  358, 1304,  380, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,
  358, 1324,  358, 484,  358, 484,  358, 484,  358, 484,  358, 484,  358, 482,  358, 482,  358, 484,  358, 1326,  358, 1324,  360, 1326,  358, 1326,
  358, 1326,  358, 1326,  356, 1326,  358, 1326,  358, 482,  358, 484,  358,  460,  382, 482,  358, 482,  358, 484,  358, 482,  360, 482,  358, 1326,  358,
  1328,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  358, 1326,  360, 1304,  380, 484,  358, 482,  358, 1326,  358, 484,
  358, 1324,  360, 462, 380, 482,  360, 484,  358, 1326,  358, 1326,  358, 484,  358, 1326,  358, 482,  360, 1326,  358, 1326,  360, 484,  358, 484,  358, 484,
  358, 1326,  358, 484,  358, 1326,  358, 1326,  358, 482,  360, 1302,  382, 1326,  358, 1328,  358, 482,  360, 1326,  358, 482,  358, 460,  382, 460,
  382, 482,  360, 482,  358, 484,  358, 482,  358, 484,  358, 482,  358, 484,  358, 1326,  358, 1326,  358, 1326,  360, 1326,  358, 1326,  358, 1326,
  358, 1326,  358, 1326,  358, 484,  358, 484,  358, 484,  358, 484,  358, 458,  382, 482,  360, 484,  358, 482,  358, 1326,  358, 1302,  384, 1326,
  358, 1326,  358, 1328,  358, 1326,  358, 1326,  358, 1326,  358};  // UNKNOWN 67E5C056

std::vector<String> commands = {
  "koizumi_cl_off", "koizumi_cl_hi", "koizumi_cl_med", "koizumi_cl_low",
  "hitachi_ac_off", "hitachi_ac_heat", "hitachi_ac_cool"
};


bool CommandParameters::validate(ESP8266WebServer* server) {
  String error;
  if (!anyOf(server->arg("data"), commands, true, error)) {
    errors->set("data", error);
  }

  if (errors->size() == 0) {
    data = argStr(server, "data");
    return true;
  }
  return false;
}


void MyHomeIRTransmitter::setup(ESP8266WebServer* server, WebSocketsServer* socket) {
  IRTransmitter::setup(server, socket);

  server->on(_route + "/command", [this, server]() {
    CommandParameters params;
    if (params.validate(server)) {
      this->sendCommand(params.data);
      this->success("");
    } else {
      this->fail(params.getErrors());
    }
  });

  server->on(_route + "/commands", [this, server]() {
    String json = this->toJsonObjectArray("commands", commands);
    this->success(json);
  });
}

bool MyHomeIRTransmitter::sendCommand(String command) {
  command.toLowerCase();
  if (command == "koizumi_cl_off") {
    sendRawData_P(CMD_KOIZUMI_CL_OFF_H, 263, 32);
    ir->sendNEC(CMD_KOIZUMI_CL_OFF);
  } else if (command == "koizumi_cl_hi") {
    sendRawData_P(CMD_KOIZUMI_CL_HI_H, 263, 32);
    ir->sendNEC(CMD_KOIZUMI_CL_HI);
  } else if (command == "koizumi_cl_med") {
    sendRawData_P(CMD_KOIZUMI_CL_MED_H, 263, 32);
    ir->sendNEC(CMD_KOIZUMI_CL_MED);
  } else if (command == "koizumi_cl_low") {
    sendRawData_P(CMD_KOIZUMI_CL_LOW_H, 263, 32);
    ir->sendNEC(CMD_KOIZUMI_CL_LOW);
  } else if (command == "hitachi_ac_off") {
    sendRawData_P(CMD_HITACHI_AC_OFF, 531, 32);
  } else if (command == "hitachi_ac_heat") {
    sendRawData_P(CMD_HITACHI_AC_HEAT, 531, 32);
  } else if (command == "hitachi_ac_cool") {
    sendRawData_P(CMD_HITACHI_AC_COOL, 531, 32);
  } else {
    return false;
  }
  return true;
}

void MyHomeIRTransmitter::sendRawData_P(const uint16_t data_P[], uint16_t len, uint16_t hz) {
  uint16_t buff[len];
  memcpy_P(buff, data_P, sizeof(uint16_t) * len);
  ir->sendRaw(buff, len, hz);
}
